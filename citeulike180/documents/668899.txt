Vol 441|25 May 2006|doi:10.1038/nature04605

LETTERS
A simple rule for the evolution of cooperation on graphs and social networks
Hisashi Ohtsuki1,2, Christoph Hauert2, Erez Lieberman2,3 & Martin A. Nowak2
A fundamental aspect of all biological systems is cooperation. Cooperative interactions are required for many levels of biological organization ranging from single cells to groups of animals1­4. Human society is based to a large extent on mechanisms that promote cooperation5­7. It is well known that in unstructured populations, natural selection favours defectors over cooperators. There is much current interest, however, in studying evolutionary games in structured populations and on graphs8­17. These efforts recognize the fact that who-meets-whom is not random, but determined by spatial relationships or social networks18­24. Here we describe a surprisingly simple rule that is a good approximation for all graphs that we have analysed, including cycles, spatial lattices, random regular graphs, random graphs and scalefree networks25,26: natural selection favours cooperation, if the benefit of the altruistic act, b, divided by the cost, c, exceeds the average number of neighbours, k, which means b/c > k. In this case, cooperation can evolve as a consequence of `social viscosity' even in the absence of reputation effects or strategic complexity. A cooperator is someone who pays a cost, c, for another individual to receive a benefit, b. A defector pays no cost and does not distribute any benefits. In evolutionary biology, cost and benefit are measured in terms of fitness. Reproduction can be genetic or cultural. In the latter case, the strategy of someone who does well is imitated by others. In an unstructured population, where all individuals are equally likely to interact with each other, defectors have a higher average payoff than unconditional cooperators. Therefore, natural selection increases the relative abundance of defectors and drives cooperators to extinction. These evolutionary dynamics hold for the deterministic setting of the replicator equation27,28 and for stochastic game dynamics of finite populations29. In our model, the players of an evolutionary game occupy the vertices of a graph. The edges denote links between individuals in terms of game dynamical interaction and biological reproduction. We assume that the graph is fixed for the duration of the evolutionary dynamics. Consider a population of N individuals consisting of cooperators and defectors. A cooperator helps all individuals to whom it is connected. If a cooperator is connected to k other individuals and i of those are cooperators, then its payoff is bi 2 ck. A defector does not provide any help, and therefore has no costs, but it can receive the benefit from neighbouring cooperators. If a defector is connected to j cooperators, then its payoff is bj. The fitness of an individual is given by a constant term, denoting the baseline fitness, plus the payoff that arises from the game. Strong selection means that the payoff is large compared to the baseline fitness; weak selection means the payoff is small compared to the baseline fitness. The idea behind weak selection is that many different factors contribute to the overall fitness of an individual, and the game under consideration is just one of those factors. At first, we will study the following update rule for evolutionary dynamics (Fig. 1): in each time step, a random individual is chosen to die, and the neighbors compete for the empty site proportional to their fitness. We call this mechanism `death­birth' updating, because it involves a death event followed by a birth. Later we will investigate other update mechanisms. Let us explore whether natural selection can favour cooperation on certain graphs. To do this, we need to calculate the probability that a single cooperator starting in a random position turns the whole population from defection to cooperation. If selection neither favours nor opposes cooperation, then this probability is 1/N, which is the fixation probability of a neutral mutant. If the fixation

Figure 1 | The rules of the game. Each individual occupies the vertex of a graph and derives a payoff, P, from interactions with adjacent individuals. A cooperator (blue) pays a cost, c, for each neighbour to receive a benefit, b. A defector (red) pays no cost and provides no benefit. The fitness of a player is given by 1 2 w þ wP, where w measures the intensity of selection. Strong selection means w ¼ 1. Weak selection means w , 1. For `death­birth' ,

updating, at each time step, a random individual is chosen to die (grey); subsequently the neighbours compete for the empty site in proportion to their fitness. In this example, the central, vacated vertex will change from a defector to a cooperator with a probability F C/(F C þ F D), where the total fitness of all adjacent cooperators and defectors is F C ¼ 4ð1 2 wÞ þ ð10b 2 16cÞw and F D ¼ 4(1 2 w) þ 3bw, respectively.

1 Department of Biology, Kyushu University, Fukuoka 812-8581, Japan. 2Program for Evolutionary Dynamics, Department of Organismic and Evolutionary Biology, Department of Mathematics, 3Department of Applied Mathematics, Harvard University, Cambridge, Massachusetts 02138, USA.

502

© 2006 Nature Publishing Group

NATURE|Vol 441|25 May 2006

LETTERS

Figure 2 | The simple rule, b/c > k, is in good agreement with numerical simulations. The parameter k denotes the degree of the graph, which is given by the (average) number of neighbours per individual. The first row illustrates the type of graph for k ¼ 2 (a) and k ¼ 4 (b­e). The second and third rows show simulation data for population sizes N ¼ 100 and N ¼ 500. The fixation probability, r, of cooperators is determined by the fraction of runs where cooperators reached fixation out of 106 runs under weak selection, w ¼ 0.01. Each type of graph is simulated for different (average)

degrees ranging from k ¼ 2 to k ¼ 10. The arrows mark b/c ¼ k. The dotted horizontal line indicates the fixation probability 1/N of neutral evolution. The data suggest that b/c . k is necessary but not sufficient. The discrepancy is larger for non-regular graphs (d, e) with high average degree (k ¼ 10). This is not surprising given that the derivation of the rule is for regular graphs and in the limit N . k. Note that the larger population size, . N ¼ 500, gives better agreement. Interactive online tutorials can be found at http://univie.ac.at/virtuallabs.

probability of a single cooperator is greater than 1/N, then selection favours the emergence of cooperation. We also calculate the fixation probability of a single defector in a population of cooperators, and compare the two fixation probabilities. The traditional well-mixed population of evolutionary game theory is represented by the complete graph, where all vertices are connected. In this special situation, cooperators are always opposed by selection. This is the fundamental intuition of classical evolutionary game theory. But what happens on other graphs? Let us first consider a cycle. Each individual is linked to two neighbours. A single cooperator could be wiped out immediately or take over one of its two neighbours. A cluster of two cooperators could expand to three cooperators or revert to a single cooperator. In any case, the lineage starting from one cooperator always forms a single cluster of cooperators, which cannot fragment into pieces. This fact allows a straightforward calculation. We find that selection favours cooperation if b/c . 2. This result holds for weak selection and large population size. Next, we study regular graphs, where each individual has exactly k neighbours. Such graphs include cycles, spatial lattices and random regular graphs. For all such graphs, a direct calculation of the fixation probability is impossible, because a single invader can lead to very complicated patterns: the emerging cluster usually breaks into many pieces, allowing a large number of conceivable geometric configurations. In general, the inherent complexity of games on graphs makes analytical investigations almost always impossible.

Nevertheless, we can calculate the fixation probability of a randomly placed mutant for any two-person, two-strategy game on a regular graph by using pair approximation and diffusion approximation (see Supplementary Information). In particular, we find that cooperators have a fixation probability greater than 1/N and defectors have a fixation probability less than 1/N, if: b=c . k The ratio of benefit to cost of the altruistic act has to exceed the degree, k, which is given by the number of neighbours per individual. This condition is derived for weak selection and under the assumption that the population size, N, is much larger than the degree, k. We find excellent agreement with numerical simulations (Fig. 2). For a given population size, b/c . k is a necessary condition for selection to favour cooperators. As the population size increases, the discrepancy between b/c . k and the numerical simulations becomes smaller. Moreover, we find that the rule also holds for random graphs25 and scale-free networks26,27, where individuals differ in the number of their neighbours. Here k denotes the average degree of the graph. Scale-free networks fit slightly less well than random graphs, presumably because they have a larger variance of the degree distribution. The intuitive justification for the b/c . k rule is illustrated in Fig. 3. Consider one cooperator and one defector competing for an empty site. The payoff for the cooperator is P C ¼ bq CjC(k 2 1) 2 ck. The payoff for the defector is P D ¼ bq CjD(k 2 1). The conditional
503

© 2006 Nature Publishing Group

LETTERS

NATURE|Vol 441|25 May 2006

Figure 3 | Some intuition for games on graphs. a, For death­birth updating, we must consider a cooperator and a defector competing for an empty site. The pair-approximation calculation shows that for weak selection the cooperator has one more cooperator among its k 2 1 other neighbours than does the defector. Hence, the cooperator has a higher chance to win the empty site if b/c . k. b, For birth­death updating, we must consider a cooperator­defector pair competing for the next reproduction event. Again the cooperator has one more cooperator among its k 2 1 other neighbours than the defector, but the focal cooperator is also a neighbour of the defector.

Hence, both competitors are linked to the same number of cooperators, and therefore the defector has a higher payoff. For birth­death updating, selection does not favour cooperation. c, On a cycle (k ¼ 2), the situation is simple. A direct calculation, for weak selection and large population size, leads to the following results. For birth­death updating, the boundary between a cluster of cooperators and defectors tends to move in favour of defectors. For death­birth updating, the cooperator cluster expands if b/c . 2. For imitation updating, the cooperator cluster expands if b/c . 4.

probability to find a cooperator next to a cooperator is q CjC and to find a cooperator next to a defector is q CjD. The cooperator pays cost c for all of its k neighbours and receives benefit b from each cooperator among its k 2 1 neighbours, excluding the contested site. The defector pays no cost, but receives benefit b from each cooperator among its k 2 1 neighbours, also excluding the contested site. The payoff that comes from the contested site is excluded, because it contributes equally to the cooperator and the defector and therefore cancels out. If P C . P D, then selection favours the cooperator. Pair-approximation shows that (k 2 1)(q CjC 2 q CjD) ¼ 1 for weak selection. Thus, the cooperator has on average one more cooperator neighbour than the defector. Therefore, we obtain PC 2 PD ¼ b 2 ck, which leads to the b/c . k rule. We have also explored other update mechanisms. Suppose at each time step a random individual is chosen to update its strategy; it will stay with its own strategy or imitate one of the neighbours proportional to fitness. For this `imitation' updating, we find that cooperators are favoured if b/c . k þ 2. This result can be obtained with an exact calculation for the cycle and with pair approximation for regular graphs. Again, there is good agreement with numerical simulations (Supplementary Fig. 4). Mathematically, imitation updating can be obtained from our earlier death­birth updating by adding loops to every vertex. Therefore, each individual is also its own neighbour. Let us define the connectivity, k, of a vertex as the total number of links connected to that vertex, noting that a loop is connected twice. Then the simple rule b/c . k holds both for the imitation and death­birth updating. There are also update rules for which selection can never favour cooperators. For example, let us consider `birth­death' updating: at each time step an individual is selected for reproduction proportional to fitness, and the offspring replaces a randomly chosen neighbour. In this case, selection always favours defectors, because only the payoff of individuals right at the boundary between cooperators and defectors matters, and there cooperators are always at a disadvantage (Fig. 3b). In the two other models, the payoffs of individuals that are one place removed from the boundary also play a role, which gives cooperation a chance to survive. Using a different model, van Baalen and Rand11 have derived a condition for the initial invasion of cooperators. In their model, the vertices of a spatial lattice (or a graph) are either empty or occupied by cooperators or defectors. There are birth, death and migration events. Implicitly, they have shown that without migration a few cooperators can successfully invade a population of defectors if b/c . k 2/(k 2 1). The difference between this result and ours is not surprising. The invasion condition of ref. 11 examines whether rare cooperators are able to increase in abundance, whereas our fixation probability includes the whole evolutionary trajectory including the initial invasion and propagation of cooperators as well as the final extinction of defectors. For a comparison of invasion and fixation criteria see Wild and Taylor30.
504

Thus, we have shown that evolutionary dynamics on graphs can favour cooperation over defection if the benefit to cost ratio, b/c, of the altruistic act exceeds the average connectivity, k. The fewer connections there are, the easier it is for natural selection to promote cooperation. In our present analysis, all connections are equally strong. A next step will be to explore graphs with weighted edges. In social networks, people might have a substantial number of connections, but only very few of them are strong. Hence, the `effective' average degree, k, of many relevant networks could be small, thereby making selection of cooperation on graphs a powerful option. Our study is theoretically motivated, but has implications for empirical research. For example, one can envisage an experiment where people are asked to play a non-repeated Prisoner's Dilemma within a given network. Certain network structures should promote cooperative behaviour more than others. In particular, more cooperation should emerge if connectivity is low. Moreover, in certain animal species there exist complicated social networks. Observational studies could reveal how network structure affects the level of cooperation; higher connectivity should reduce cooperation. In this paper, as a logical first step, we have studied the simplest possible interaction between unconditional cooperators and defectors, but in an extended approach, both in terms of theory and experiment, it will be interesting to see which strategies of direct or indirect reciprocity evolve on particular networks. Finally, we note the beautiful similarity of our finding with Hamilton's rule1 , which states that kin selection can favour cooperation provided b/c . 1/r, where r is the coefficient of genetic relatedness between individuals. The similarity makes sense. In our framework, the average degree of a graph is an inverse measure of social relatedness (or social viscosity). The fewer friends I have the more strongly my fate is bound to theirs.
Received 7 December 2005; accepted 26 January 2006.
1. Hamilton, W. D. The genetical evolution of social behaviour. J. Theor. Biol. 7, 1­ (1964). -16 2. Trivers, R. The evolution of reciprocal altruism. Q. Rev. Biol. 46, 35­ -57 (1971). 3. Axelrod, R. & Hamilton, W. D. The evolution of cooperation. Science 211, 1390­ -1396 (1981). 4. Wilson, E. O. Sociobiology (Harvard Univ. Press, Cambridge, Massachusetts, 1975). 5. Wedekind, C. & Milinski, M. Cooperation through image scoring in humans. Science 288, 850­ -852 (2000). 6. Fehr, E. & Fischbacher, U. The nature of human altruism. Nature 425, 785­ -791 (2003). 7. Nowak, M. A. & Sigmund, K. Evolution of indirect reciprocity. Nature 437, 1291­ -1298 (2005). 8. Nowak, M. A. & May, R. M. Evolutionary games and spatial chaos. Nature 359, 826­ -829 (1992). 9. Killingback, T. & Doebeli, M. Spatial evolutionary game theory: Hawks and Doves revisited. Proc. R. Soc. Lond. B 263, 1135­ -1144 (1996). 10. Nakamaru, M., Matsuda, H. & Iwasa, Y. The evolution of cooperation in a lattice-structured population. J. Theor. Biol. 184, 65­ (1997). -81

© 2006 Nature Publishing Group

NATURE|Vol 441|25 May 2006

LETTERS

11. 12. 13.

14. 15. 16.

17.

18. 19. 20. 21. 22. 23.

van Baalen, M. & Rand, D. A. The unit of selection in viscous populations and the evolution of altruism. J. Theor. Biol. 193, 631­ -648 (1998). Mitteldorf, J. & Wilson, D. S. Population viscosity and the evolution of altruism. J. Theor. Biol. 204, 481­ -496 (2000). Hauert, C., De Monte, S., Hofbauer, J. & Sigmund, K. Volunteering as red queen mechanism for cooperation in public goods games. Science 296, 1129­ -1132 (2002). Le Galliard, J., Ferriere, R. & Dieckman, U. The adaptive dynamics of altruism in spatially heterogeneous populations. Evolution 57, 1­ (2003). -17 Hauert, C. & Doebeli, M. Spatial structure often inhibits the evolution of cooperation in the snowdrift game. Nature 428, 643­ -646 (2004). Ifti, M., Killingback, T. & Doebeli, M. Effects of neighbourhood size and connectivity on the spatial continuous prisoner's dilemma. J. Theor. Biol. 231, 97­ -106 (2004). Santos, F. C. & Pacheco, J. M. Scale-free networks provide a unifying framework for the emergence of cooperation. Phys. Rev. Lett. 95, 098104 (2005). Levin, S. A. & Paine, R. T. Disturbance, patch formation, and community structure. Proc. Natl Acad. Sci. USA 71, 2744­ -2747 (1974). Durrett, R. & Levin, S. A. The importance of being discrete (and spatial). Theor. Popul. Biol. 46, 363­ -394 (1994). Hassell, M. P., Comins, H. N. & May, R. M. Species coexistence and self-organizing spatial dynamics. Nature 370, 290­ -292 (1994). Skyrms, B. & Pemantle, R. A dynamic model of social network formation. Proc. Natl Acad. Sci. USA 97, 9340­ -9346 (2000). Abramson, G. & Kuperman, M. Social games in a social network. Phys. Rev. E 63, 030901 (2001). ´ Szabo, G. & Vukov, J. Cooperation for volunteering and partially random partnership. Phys. Rev. E 69, 036107 (2004).

24. Lieberman, E., Hauert, C. & Nowak, M. A. Evolutionary dynamics on graphs. Nature 433, 312­ -316 (2005). 25. Watts, D. J. & Strogatz, S. H. Collective dynamics of `small-world' networks. Nature 393, 440­ -442 (1998). 26. Barabasi, A. & Albert, R. Emergence of scaling in random networks. Science 286, 509­ -512 (1999). 27. Taylor, P. D. & Jonker, L. Evolutionary stable strategies and game dynamics. Math. Biosci. 40, 145­ -156 (1978). 28. Hofbauer, J. & Sigmund, K. Evolutionary Games and Population Dynamics (Cambridge Univ. Press, Cambridge, UK, 1998). 29. Nowak, M. A., Sasaki, A., Taylor, C. & Fudenberg, D. Emergence of cooperation and evolutionary stability in finite populations. Nature 428, 646­ -650 (2004). 30. Wild, G. & Taylor, P. D. Fitness and evolutionary stability in game theoretic models of finite populations. Proc. R. Soc. Lond. B 271, 2345­ -2349 (2004).

Supplementary Information is linked to the online version of the paper at www.nature.com/nature. Acknowledgements Support from the John Templeton Foundation, JSPS, NDSEG and Harvard-MIT HST is gratefully acknowledged. The Program for Evolutionary Dynamics at Harvard University is sponsored by Jeffrey Epstein. Author Information Reprints and permissions information is available at npg.nature.com/reprintsandpermissions. The authors declare no competing financial interests. Correspondence and requests for materials should be addressed to M.A.N. (martin_nowak@harvard.edu).

© 2006 Nature Publishing Group

505

